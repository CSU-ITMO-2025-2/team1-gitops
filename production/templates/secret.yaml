{{- $secrets := .Values.secrets | default (dict) -}}
{{- $useExternal := and (hasKey $secrets "useExternal") $secrets.useExternal -}}
{{- $useExisting := and (hasKey $secrets "useExisting") $secrets.useExisting -}}

{{- if not (or $useExternal $useExisting) }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ .Release.Name }}-secrets
type: Opaque
stringData:
  # LLM
  OPENAI_API_KEY: {{ default "" $secrets.openaiApiKey | quote }}

  # Keycloak
  KC_CLIENT_SECRET: {{ default "" $secrets.kcClientSecret | quote }}

  # RabbitMQ
  RABBITMQ_DEFAULT_PASS: {{ default "" $secrets.rabbitmqPassword | quote }}

  # PostgreSQL
  POSTGRES_PASSWORD: {{ default "" $secrets.postgresPassword | quote }}
{{- end }}
